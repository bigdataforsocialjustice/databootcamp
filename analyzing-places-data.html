<!DOCTYPE html>
<html><head>
			
		<title>Analyzing Places Data</title>
		<base href="./">
		<meta id="root-path" root-path="./">

		<link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<script src="https://code.iconify.design/iconify-icon/1.0.3/iconify-icon.min.js"></script>

			<link rel="stylesheet" href="lib/styles/obsidian-styles.css">
			<link rel="stylesheet" href="lib/styles/theme.css">
			<link rel="stylesheet" href="lib/styles/plugin-styles.css">
			<link rel="stylesheet" href="lib/styles/snippets.css">
			<style>  </style>

			
			<!-- Graph View Data -->
			<script>
			let nodes=
{"nodeCount":34,"linkCount":41,"radii":[7,7,7,6.595041322314049,6.595041322314049,6.2541322314049586,5.809917355371901,5.809917355371901,5.809917355371901,5.2623966942148765,5.2623966942148765,5.2623966942148765,4.6115702479338845,4.6115702479338845,4.6115702479338845,3.857438016528926,3.857438016528926,3.857438016528926,3.857438016528926,3.857438016528926,3.857438016528926,3.857438016528926,3,3,3,3,3,3,3,3,3,3,3,3],"labels":["Day 2","Day 1","Datasets","Day 5","Day 3","Syllabus","Mapping Homelessness in San Diego","Example 1","Day 4","Analyzing Places Data","San Diego Regional Data Library data example","National Survey of Child Health","In-school suspensions and academic achievement","Fatal police shootings","Add Health","A note on data mining","Geographic differences in discharge dispositions","Housing and Transportation Affordability Index","Household Pulse Survey Data Tables","Final web scrap medium","Consumer Complaints","Add-on Packages & Modules","Research Reminders","Note taking","Lit Reviews","Daily Note","Example Template","Research Notes","research notes","Research Paper","Research Ideas","focus_group","Cheat Sheet","Highlighting structure"],"paths":["day-2.html","day-1.html","datasets.html","day-5.html","day-3.html","syllabus.html","mapping-homelessness-in-san-diego.html","example-1.html","day-4.html","analyzing-places-data.html","san-diego-regional-data-library-data-example.html","national-survey-of-child-health.html","in-school-suspensions-and-academic-achievement.html","fatal-police-shootings.html","add-health.html","a-note-on-data-mining.html","geographic-differences-in-discharge-dispositions.html","housing-and-transportation-affordability-index.html","household-pulse-survey-data-tables.html","final-web-scrap-medium.html","consumer-complaints.html","add-on-packages-&-modules.html","00-meta/003-tools/research-reminders.html","00-meta/003-tools/note-taking.html","00-meta/003-tools/lit-reviews.html","00-meta/002-templates/daily-note.html","00-meta/002-templates/example-template.html","00-meta/002-templates/research-notes.html","00-meta/002-templates/meta/zdc-templates/research-notes.html","00-meta/002-templates/meta/zdc-templates/research-paper.html","00-meta/002-templates/meta/zdc-templates/research-ideas.html","00-meta/002-templates/meta/zdc-templates/focus_group.html","00-meta/001-structure/cheat-sheet.html","00-meta/001-structure/highlighting-structure.html"],"linkSources":[2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,7,7,10,5,5,5,5,5,1,1,1,1,1,0,0,0,4,4,4,4,8,6,6,6,12,9],"linkTargets":[0,3,14,20,13,17,9,11,18,15,10,14,1,0,4,8,16,8,1,0,4,8,3,21,19,7,2,12,9,7,11,0,1,11,13,6,10,0,1,0,2]};
			let attractionForce = 1;
			let linkLength = 10;
			let repulsionForce = 150;
			let centralForce = 3;
			let edgePruning = 100;
			</script>
			
<script type="module" src="lib/scripts/graph_view.js"></script>

<script src="lib/scripts/graph_wasm.js"></script>

<script src="lib/scripts/tinycolor.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="lib/scripts/webpage.js"></script>

			</head><body class="theme-dark mod-windows is-frameless is-hidden-frameless obsidian-app show-inline-title show-view-header outliner-plugin-better-lists outliner-plugin-dnd" style="--zoom-factor:1.2; --font-text-size:16px; --line-width:50em; --line-width-adaptive:50em; --file-line-width:50em; --content-width:500em; --sidebar-width:25em; --collapse-arrow-size:0.4em; --tree-horizontal-spacing:1em; --tree-vertical-spacing:0.5em; --sidebar-margin:12px;"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Bootcamp</span><button class="clickable-icon collapse-tree-button is-collapsed"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"></div></div></div></div><div class="document-container"><div class="markdown-preview-view markdown-rendered node-insert-event allow-fold-headings show-indentation-guide allow-fold-lists" tabindex="-1" style="tab-size: 4;"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: ; padding-top: var(--file-margins); padding-right: var(--file-margins); padding-left: var(--file-margins); width: 100%; position: absolute;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Analyzing Places Data</div></div><div><h1 data-heading="Introduction" id="Introduction">Introduction</h1></div><div><p>There is quite a bit of data wrangling that needs to be done before you can use the CDC's Places dataset. It is also nice to be able to have access to the data without having to download it onto your computer. Many open data websites allow you to connect to data in the repository through the Application Programming Interface, or API. </p></div><div><p>Here, I show you how this can be done using the Places dataset. The code connects to the data, reshapes, recodes and filters the data, and gets it ready for mapping, all in one fell swoop.</p></div><div><p>As you can see from the website the <a data-tooltip-position="top" aria-label="https://data.cdc.gov/500-Cities-Places/PLACES-Census-Tract-Data-GIS-Friendly-Format-2023-/yjkw-uj5s/explore/query/SELECT%0A%20%20%60stateabbr%60%2C%0A%20%20%60statedesc%60%2C%0A%20%20%60countyname%60%2C%0A%20%20%60countyfips%60%2C%0A%20%20%60tractfips%60%2C%0A%20%20%60totalpopulation%60%2C%0A%20%20%60access2_crudeprev%60%2C%0A%20%20%60access2_crude95ci%60%2C%0A%20%20%60arthritis_crudeprev%60%2C%0A%20%20%60arthritis_crude95ci%60%2C%0A%20%20%60binge_crudeprev%60%2C%0A%20%20%60binge_crude95ci%60%2C%0A%20%20%60bphigh_crudeprev%60%2C%0A%20%20%60bphigh_crude95ci%60%2C%0A%20%20%60bpmed_crudeprev%60%2C%0A%20%20%60bpmed_crude95ci%60%2C%0A%20%20%60cancer_crudeprev%60%2C%0A%20%20%60cancer_crude95ci%60%2C%0A%20%20%60casthma_crudeprev%60%2C%0A%20%20%60casthma_crude95ci%60%2C%0A%20%20%60cervical_crudeprev%60%2C%0A%20%20%60cervical_crude95ci%60%2C%0A%20%20%60chd_crudeprev%60%2C%0A%20%20%60chd_crude95ci%60%2C%0A%20%20%60checkup_crudeprev%60%2C%0A%20%20%60checkup_crude95ci%60%2C%0A%20%20%60cholscreen_crudeprev%60%2C%0A%20%20%60cholscreen_crude95ci%60%2C%0A%20%20%60colon_screen_crudeprev%60%2C%0A%20%20%60colon_screen_crude95ci%60%2C%0A%20%20%60copd_crudeprev%60%2C%0A%20%20%60copd_crude95ci%60%2C%0A%20%20%60corem_crudeprev%60%2C%0A%20%20%60corem_crude95ci%60%2C%0A%20%20%60corew_crudeprev%60%2C%0A%20%20%60corew_crude95ci%60%2C%0A%20%20%60csmoking_crudeprev%60%2C%0A%20%20%60csmoking_crude95ci%60%2C%0A%20%20%60dental_crudeprev%60%2C%0A%20%20%60dental_crude95ci%60%2C%0A%20%20%60depression_crudeprev%60%2C%0A%20%20%60depression_crude95ci%60%2C%0A%20%20%60diabetes_crudeprev%60%2C%0A%20%20%60diabetes_crude95ci%60%2C%0A%20%20%60ghlth_crudeprev%60%2C%0A%20%20%60ghlth_crude95ci%60%2C%0A%20%20%60highchol_crudeprev%60%2C%0A%20%20%60highchol_crude95ci%60%2C%0A%20%20%60kidney_crudeprev%60%2C%0A%20%20%60kidney_crude95ci%60%2C%0A%20%20%60lpa_crudeprev%60%2C%0A%20%20%60lpa_crude95ci%60%2C%0A%20%20%60mammouse_crudeprev%60%2C%0A%20%20%60mammouse_crude95ci%60%2C%0A%20%20%60mhlth_crudeprev%60%2C%0A%20%20%60mhlth_crude95ci%60%2C%0A%20%20%60obesity_crudeprev%60%2C%0A%20%20%60obesity_crude95ci%60%2C%0A%20%20%60phlth_crudeprev%60%2C%0A%20%20%60phlth_crude95ci%60%2C%0A%20%20%60sleep_crudeprev%60%2C%0A%20%20%60sleep_crude95ci%60%2C%0A%20%20%60stroke_crudeprev%60%2C%0A%20%20%60stroke_crude95ci%60%2C%0A%20%20%60teethlost_crudeprev%60%2C%0A%20%20%60teethlost_crude95ci%60%2C%0A%20%20%60hearing_crudeprev%60%2C%0A%20%20%60hearing_crude95ci%60%2C%0A%20%20%60vision_crudeprev%60%2C%0A%20%20%60vision_crude95ci%60%2C%0A%20%20%60cognition_crudeprev%60%2C%0A%20%20%60cognition_crude95ci%60%2C%0A%20%20%60mobility_crudeprev_%60%2C%0A%20%20%60mobility_crude95ci%60%2C%0A%20%20%60selfcare_crudeprev%60%2C%0A%20%20%60selfcare_crude95ci%60%2C%0A%20%20%60indeplive_crudeprev%60%2C%0A%20%20%60indeplive_crude95ci%60%2C%0A%20%20%60disability_crudeprev%60%2C%0A%20%20%60disability_crude95ci%60%2C%0A%20%20%60geolocation%60/page/filter" rel="noopener" class="external-link" href="https://data.cdc.gov/500-Cities-Places/PLACES-Census-Tract-Data-GIS-Friendly-Format-2023-/yjkw-uj5s/explore/query/SELECT%0A%20%20%60stateabbr%60%2C%0A%20%20%60statedesc%60%2C%0A%20%20%60countyname%60%2C%0A%20%20%60countyfips%60%2C%0A%20%20%60tractfips%60%2C%0A%20%20%60totalpopulation%60%2C%0A%20%20%60access2_crudeprev%60%2C%0A%20%20%60access2_crude95ci%60%2C%0A%20%20%60arthritis_crudeprev%60%2C%0A%20%20%60arthritis_crude95ci%60%2C%0A%20%20%60binge_crudeprev%60%2C%0A%20%20%60binge_crude95ci%60%2C%0A%20%20%60bphigh_crudeprev%60%2C%0A%20%20%60bphigh_crude95ci%60%2C%0A%20%20%60bpmed_crudeprev%60%2C%0A%20%20%60bpmed_crude95ci%60%2C%0A%20%20%60cancer_crudeprev%60%2C%0A%20%20%60cancer_crude95ci%60%2C%0A%20%20%60casthma_crudeprev%60%2C%0A%20%20%60casthma_crude95ci%60%2C%0A%20%20%60cervical_crudeprev%60%2C%0A%20%20%60cervical_crude95ci%60%2C%0A%20%20%60chd_crudeprev%60%2C%0A%20%20%60chd_crude95ci%60%2C%0A%20%20%60checkup_crudeprev%60%2C%0A%20%20%60checkup_crude95ci%60%2C%0A%20%20%60cholscreen_crudeprev%60%2C%0A%20%20%60cholscreen_crude95ci%60%2C%0A%20%20%60colon_screen_crudeprev%60%2C%0A%20%20%60colon_screen_crude95ci%60%2C%0A%20%20%60copd_crudeprev%60%2C%0A%20%20%60copd_crude95ci%60%2C%0A%20%20%60corem_crudeprev%60%2C%0A%20%20%60corem_crude95ci%60%2C%0A%20%20%60corew_crudeprev%60%2C%0A%20%20%60corew_crude95ci%60%2C%0A%20%20%60csmoking_crudeprev%60%2C%0A%20%20%60csmoking_crude95ci%60%2C%0A%20%20%60dental_crudeprev%60%2C%0A%20%20%60dental_crude95ci%60%2C%0A%20%20%60depression_crudeprev%60%2C%0A%20%20%60depression_crude95ci%60%2C%0A%20%20%60diabetes_crudeprev%60%2C%0A%20%20%60diabetes_crude95ci%60%2C%0A%20%20%60ghlth_crudeprev%60%2C%0A%20%20%60ghlth_crude95ci%60%2C%0A%20%20%60highchol_crudeprev%60%2C%0A%20%20%60highchol_crude95ci%60%2C%0A%20%20%60kidney_crudeprev%60%2C%0A%20%20%60kidney_crude95ci%60%2C%0A%20%20%60lpa_crudeprev%60%2C%0A%20%20%60lpa_crude95ci%60%2C%0A%20%20%60mammouse_crudeprev%60%2C%0A%20%20%60mammouse_crude95ci%60%2C%0A%20%20%60mhlth_crudeprev%60%2C%0A%20%20%60mhlth_crude95ci%60%2C%0A%20%20%60obesity_crudeprev%60%2C%0A%20%20%60obesity_crude95ci%60%2C%0A%20%20%60phlth_crudeprev%60%2C%0A%20%20%60phlth_crude95ci%60%2C%0A%20%20%60sleep_crudeprev%60%2C%0A%20%20%60sleep_crude95ci%60%2C%0A%20%20%60stroke_crudeprev%60%2C%0A%20%20%60stroke_crude95ci%60%2C%0A%20%20%60teethlost_crudeprev%60%2C%0A%20%20%60teethlost_crude95ci%60%2C%0A%20%20%60hearing_crudeprev%60%2C%0A%20%20%60hearing_crude95ci%60%2C%0A%20%20%60vision_crudeprev%60%2C%0A%20%20%60vision_crude95ci%60%2C%0A%20%20%60cognition_crudeprev%60%2C%0A%20%20%60cognition_crude95ci%60%2C%0A%20%20%60mobility_crudeprev_%60%2C%0A%20%20%60mobility_crude95ci%60%2C%0A%20%20%60selfcare_crudeprev%60%2C%0A%20%20%60selfcare_crude95ci%60%2C%0A%20%20%60indeplive_crudeprev%60%2C%0A%20%20%60indeplive_crude95ci%60%2C%0A%20%20%60disability_crudeprev%60%2C%0A%20%20%60disability_crude95ci%60%2C%0A%20%20%60geolocation%60/page/filter" target="_blank">Places dataset</a> has a lot of variables. I am going to only select the mental health variable to analyze.<br>
I have never used this data in my own work yet, however, take a loot at this <a data-tooltip-position="top" aria-label="https://www-sciencedirect-com.proxy.lib.ohio-state.edu/science/article/pii/S0146280622004303?casa_token=nIbo1P_tQz4AAAAA:PNNHDynLU5wK170ucyKTfZwlJQxYVz8RuTzj5i-KQ3BOsTEJ5hxvSsiuJ_0NHB2oq8yS-vcOZLWY" rel="noopener" class="external-link" href="https://www-sciencedirect-com.proxy.lib.ohio-state.edu/science/article/pii/S0146280622004303?casa_token=nIbo1P_tQz4AAAAA:PNNHDynLU5wK170ucyKTfZwlJQxYVz8RuTzj5i-KQ3BOsTEJ5hxvSsiuJ_0NHB2oq8yS-vcOZLWY" target="_blank">recent paper</a> that did. The paper explores Neighborhood Walkability and Cardiovascular Risk in the United States. You could do something similar by merging this data with the national walkability index (see <a data-href="Datasets" href="datasets.html" class="internal-link" target="_self" rel="noopener">Datasets</a>).</p></div><div><pre class="language-r" tabindex="0"><code class="language-r is-loaded"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">"remotes"</span> <span class="token percent-operator operator">%in%</span> installed.packages<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  install.packages<span class="token punctuation">(</span><span class="token string">"remotes"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

cran_pkgs <span class="token operator">=</span> c<span class="token punctuation">(</span>
  <span class="token string">"sf"</span><span class="token punctuation">,</span>
  <span class="token string">"tidygraph"</span><span class="token punctuation">,</span>
  <span class="token string">"igraph"</span><span class="token punctuation">,</span>
  <span class="token string">"osmdata"</span><span class="token punctuation">,</span>
  <span class="token string">"dplyr"</span><span class="token punctuation">,</span>
  <span class="token string">"tibble"</span><span class="token punctuation">,</span>
  <span class="token string">"ggplot2"</span><span class="token punctuation">,</span>
  <span class="token string">"units"</span><span class="token punctuation">,</span>
  <span class="token string">"tmap"</span><span class="token punctuation">,</span>
  <span class="token string">"rgrass7"</span><span class="token punctuation">,</span>
  <span class="token string">"link2GI"</span><span class="token punctuation">,</span>
  <span class="token string">"nabor"</span>
<span class="token punctuation">)</span>

remotes<span class="token operator">::</span>install_cran<span class="token punctuation">(</span>cran_pkgs<span class="token punctuation">)</span>

library<span class="token punctuation">(</span>sf<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tidygraph<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>igraph<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>dplyr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tibble<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ggplot2<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>units<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tmap<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>osmdata<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>rgrass7<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>link2GI<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>nabor<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>RSocrata<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tidyr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>sf<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tigris<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tidyverse<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>tidycensus<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>stplanr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>censusapi<span class="token punctuation">)</span>

<span class="token comment"># setwd("")</span>
root.dir <span class="token operator">=</span> <span class="token string">"https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/DATA/"</span>
source<span class="token punctuation">(</span><span class="token string">"https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/functions.r"</span><span class="token punctuation">)</span>

options<span class="token punctuation">(</span>scipen<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
<span class="token comment">#https://datacatalog.cookcountyil.gov/api/odata/v4/cjeq-bs86</span>

cdc_places <span class="token operator">&lt;-</span> 
  read.socrata<span class="token punctuation">(</span><span class="token string">"https://data.cdc.gov/resource/nw2y-v4gm.json?"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  <span class="token comment">#read.csv("C:/Users/barboza-salerno.1/Downloads/PLACES__Local_Data_for_Better_Health__Census_Tract_Data_2022_release.csv") %&gt;%</span>
  dplyr<span class="token operator">::</span>filter<span class="token punctuation">(</span>stateabbr <span class="token operator">==</span> <span class="token string">'OH'</span> <span class="token operator">&amp;</span> countyname <span class="token operator">==</span> <span class="token string">"Franklin"</span> <span class="token operator">&amp;</span> year <span class="token operator">==</span> <span class="token number">2020</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  dplyr<span class="token operator">::</span>mutate<span class="token punctuation">(</span>x <span class="token operator">=</span> gsub<span class="token punctuation">(</span><span class="token string">"[c()]"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> geolocation.coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  <span class="token comment">#trim(x) %&gt;%</span>
  separate<span class="token punctuation">(</span>x<span class="token punctuation">,</span>into<span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span><span class="token string">"Y"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  dplyr<span class="token operator">::</span>select<span class="token punctuation">(</span>
    GEOID <span class="token operator">=</span> locationname<span class="token punctuation">,</span> 
    category <span class="token operator">=</span> category<span class="token punctuation">,</span> 
    measure <span class="token operator">=</span> measure<span class="token punctuation">,</span> 
    value <span class="token operator">=</span> data_value<span class="token punctuation">,</span> 
    lci <span class="token operator">=</span> low_confidence_limit<span class="token punctuation">,</span> 
    uci <span class="token operator">=</span> high_confidence_limit<span class="token punctuation">,</span> 
    pop <span class="token operator">=</span> totalpopulation<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y
  <span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  dplyr<span class="token operator">::</span>mutate<span class="token punctuation">(</span>
    X <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    Y <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    value <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    lci <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>lci<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    uci <span class="token operator">=</span> as.numeric<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>uci<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>         
 pivot_wider<span class="token punctuation">(</span>names_from <span class="token operator">=</span> c<span class="token punctuation">(</span>category<span class="token operator">:</span>measure<span class="token punctuation">)</span><span class="token punctuation">,</span> values_from <span class="token operator">=</span> c<span class="token punctuation">(</span>value<span class="token operator">:</span>uci<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
 dplyr<span class="token operator">::</span>select<span class="token punctuation">(</span>GEOID<span class="token punctuation">,</span> `value_Health Status_Mental health not good <span class="token keyword">for</span> <span class="token operator">&gt;=</span><span class="token number">14</span> days among adults aged <span class="token operator">&gt;=</span><span class="token number">18</span> years` <span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
dplyr<span class="token operator">::</span>rename<span class="token punctuation">(</span>mental_health <span class="token operator">=</span> `value_Health Status_Mental health not good <span class="token keyword">for</span> <span class="token operator">&gt;=</span><span class="token number">14</span> days among adults aged <span class="token operator">&gt;=</span><span class="token number">18</span> years`<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> 
  st_as_sf<span class="token punctuation">(</span>coords <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"Y"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> crs <span class="token operator">=</span> <span class="token number">4326</span><span class="token punctuation">,</span> agr <span class="token operator">=</span> <span class="token string">"constant"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  st_transform<span class="token punctuation">(</span><span class="token string">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> cdc_places_sf

st_read<span class="token punctuation">(</span><span class="token string">"https://raw.githubusercontent.com/deldersveld/topojson/master/countries/us-states/OH-39-ohio-counties.json"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  filter<span class="token punctuation">(</span>NAME <span class="token operator">==</span> <span class="token string">"Franklin"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  st_set_crs<span class="token punctuation">(</span><span class="token number">4326</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  st_transform<span class="token punctuation">(</span><span class="token string">"+proj=longlat +datum=WGS84 +no_defs"</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> ohio

border <span class="token operator">&lt;-</span> st_union<span class="token punctuation">(</span>ohio<span class="token punctuation">)</span>

<span class="token comment">#url = "https://edg.epa.gov/EPADataCommons/public/OA/WalkabilityIndex.zip"</span>
library<span class="token punctuation">(</span>crsuggest<span class="token punctuation">)</span>

walkies <span class="token operator">&lt;-</span> st_read<span class="token punctuation">(</span><span class="token string">"I:/health/ohio/NationalWalkabilityI_Project1.shp"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  st_set_crs<span class="token punctuation">(</span><span class="token number">4326</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  st_transform<span class="token punctuation">(</span><span class="token string">"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs"</span><span class="token punctuation">)</span>

rivers <span class="token operator">&lt;-</span> linear_water<span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token string">"Ohio"</span><span class="token punctuation">,</span> <span class="token string">"Franklin"</span><span class="token punctuation">,</span> class<span class="token operator">=</span><span class="token string">"sf"</span><span class="token punctuation">)</span>
water <span class="token operator">&lt;-</span> area_water<span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token string">"Ohio"</span><span class="token punctuation">,</span> <span class="token string">"Franklin"</span><span class="token punctuation">,</span> class <span class="token operator">=</span> <span class="token string">"sf"</span><span class="token punctuation">)</span>
rd <span class="token operator">&lt;-</span> roads<span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token string">"Ohio"</span><span class="token punctuation">,</span> <span class="token string">"Franklin"</span><span class="token punctuation">,</span> class <span class="token operator">=</span> <span class="token string">"sf"</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  filter<span class="token punctuation">(</span>RTTYP <span class="token operator">==</span> <span class="token string">"I"</span><span class="token punctuation">)</span>

ggplot<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> walkies<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">0.0725</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> NatWalkInd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf_label<span class="token punctuation">(</span>
    data <span class="token operator">=</span> ohio<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> lineheight <span class="token operator">=</span> <span class="token number">0.875</span><span class="token punctuation">,</span>
    label.padding <span class="token operator">=</span> unit<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token string">"lines"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> label.size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token string">"white"</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_fill_viridis_c<span class="token punctuation">(</span>
    direction <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> limits <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"Walkability Index"</span><span class="token punctuation">,</span>
    breaks <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"0 (Nigh impassable)"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"20 (Very walkable)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>
    x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
    title <span class="token operator">=</span> <span class="token string">"Walkability Index for Franklin County, Ohio"</span><span class="token punctuation">,</span>
    caption <span class="token operator">=</span> <span class="token string">"Data source: EPA DataCommons Walkability Index"</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>plot.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span>hjust <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.position <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span> hjust <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.box.background <span class="token operator">=</span> element_rect<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"#2b2b2b"</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme_void<span class="token punctuation">(</span><span class="token punctuation">)</span>

walkies_CT <span class="token operator">&lt;-</span> walkies <span class="token percent-operator operator">%&gt;%</span>
  unite<span class="token punctuation">(</span><span class="token string">"GEOID"</span><span class="token punctuation">,</span> STATEFP<span class="token operator">:</span>TRACTCE<span class="token punctuation">,</span> sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> remove <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  dplyr<span class="token operator">::</span>select<span class="token punctuation">(</span>GEOID<span class="token punctuation">,</span> NatWalkInd<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span>
  group_by<span class="token punctuation">(</span>GEOID<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> summarize<span class="token punctuation">(</span>NatWalkInd <span class="token operator">=</span> mean<span class="token punctuation">(</span>NatWalkInd<span class="token punctuation">)</span><span class="token punctuation">)</span>


walkies_CT <span class="token operator">&lt;-</span> walkies_CT <span class="token percent-operator operator">%&gt;%</span> left_join<span class="token punctuation">(</span>cdc_places<span class="token punctuation">)</span>

ggplot<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> walkies_CT<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">0.0725</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>fill <span class="token operator">=</span> NatWalkInd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> cdc_places_sf<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>size <span class="token operator">=</span> mental_health<span class="token punctuation">)</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  <span class="token comment">#geom_sf(data = walkies_CT, color = "white", size = 0.0725, aes(fill = value_BINGE_RISKBEH)) +</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> rd<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"#999999"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> rd<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> rd<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"#aaaaaa"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf<span class="token punctuation">(</span>data <span class="token operator">=</span> rivers<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"lightblue"</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  geom_sf_label<span class="token punctuation">(</span>
    data <span class="token operator">=</span> ohio<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> lineheight <span class="token operator">=</span> <span class="token number">0.875</span><span class="token punctuation">,</span>
    label.padding <span class="token operator">=</span> unit<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token string">"lines"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> label.size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token string">"white"</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  scale_fill_viridis_c<span class="token punctuation">(</span>
    direction <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> limits <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"Walkability Index"</span><span class="token punctuation">,</span>
    breaks <span class="token operator">=</span> seq<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"0 (Nigh impassable)"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"20 (Very walkable)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  labs<span class="token punctuation">(</span>
    x <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
    title <span class="token operator">=</span> <span class="token string">"Walkability Index for Franklin County, Ohio"</span><span class="token punctuation">,</span>
    caption <span class="token operator">=</span> <span class="token string">"Data source: EPA DataCommons Walkability Index"</span>
  <span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>plot.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span>hjust <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.position <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span> hjust <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  theme<span class="token punctuation">(</span>legend.box.background <span class="token operator">=</span> element_rect<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"#2b2b2b"</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> theme_void<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code><button class="copy-code-button">Copy</button></pre></div><div><p>This code produces the plot of mental health and walkability. As an exercise, you should change the mental health variable to obesity and explore the spatial relations.<br>
<span alt="Pasted image 20230806174220.png" src="Pasted image 20230806174220.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20230806174220.png" src="pasted-image-20230806174220.png"></span></p></div><div class="mod-footer"><div class="embedded-backlinks" style="display: none;"></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-content"><span class="sidebar-section-header">Interactive Graph</span><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-arrow-up-right"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" width="512px" height="512px"></canvas>
		</div>
		</div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-heading" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="#Introduction"><span class="tree-item-title">Introduction</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></body></html>